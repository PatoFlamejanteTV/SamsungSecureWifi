ifeq ($(BLOWFISH_FRAMEWORK),true)
LOCAL_PATH := $(call my-dir)

ifneq ($(filter $(TARGET_BOARD_PLATFORM), mt6757),)
BLOWFISH_TARGET_SOC := $(TARGET_BOARD_PLATFORM)
else ifneq ($(filter $(TARGET_SOC), exynos7570),)
BLOWFISH_TARGET_SOC := $(TARGET_SOC)
endif

$(info BlowFish target SOC : $(BLOWFISH_TARGET_SOC))

include $(CLEAR_VARS)
LOCAL_MODULE        := tzdaemon
LOCAL_MODULE_TAGS   := optional
ifneq ($(filter $(BLOWFISH_TARGET_SOC), mt6757),)
LOCAL_REQUIRED_MODULES :=
endif

ifneq ($(filter $(BLOWFISH_TARGET_SOC), exynos7570),)
LOCAL_REQUIRED_MODULES := \
	18d9f073-18a5-4ade-9def-875e07f7f293_
endif

#TIMA MODULES
ifneq ($(filter $(BLOWFISH_TARGET_SOC), exynos7570 mt6757),)
LOCAL_REQUIRED_MODULES += \
	tzdaemon_recovery \
	00000000-0000-0000-0000-00535453540a \
	00000000-0000-0000-0000-00535453540b \
	00000000-0000-0000-0000-00535453540c \
	00000000-0000-0000-0000-00535453540d \
	00000000-0000-0000-0000-00535453540f \
	00000000-0000-0000-0000-00000000dead 
endif

#ICCC
ifneq ($(filter $(BLOWFISH_TARGET_SOC), mt6757),)
LOCAL_REQUIRED_MODULES += \
	00000000-0000-0000-0000-0053545354ab
endif

#SEM MODULES
ifneq ($(filter $(BLOWFISH_TARGET_SOC), mt6757),)
LOCAL_REQUIRED_MODULES += \
	00000000-0000-0000-0000-53454d655345
endif

#SKPM MODULES
ifeq ($(BLOWFISH_TARGET_SOC), $(filter exynos7570 mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += \
	00000000-0000-0000-0000-0000534b504d
endif

#Vaultkeeper
ifneq ($(filter $(BLOWFISH_TARGET_SOC), exynos7570 mt6757),)
LOCAL_REQUIRED_MODULES += \
	00000000-0000-0000-0000-564c544b5052
endif

#WSM
ifeq (true,$(call spf_check,SEC_PRODUCT_FEATURE_SECURITY_SUPPORT_WSM,TRUE))
LOCAL_REQUIRED_MODULES += \
    ffffffff-0000-0000-0000-000000000030
endif

#KEYMASTER & GATEKEEPER
ifeq ($(BLOWFISH_TARGET_SOC), $(filter exynos7570 mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += \
	gatekeeper.$(BLOWFISH_TARGET_SOC) \
	keystore.$(BLOWFISH_TARGET_SOC)
endif

#HDCP
ifeq ($(BLOWFISH_TARGET_SOC), $(filter mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += 00000000-0000-0000-0000-000048444350
endif

#MirrorLink
ifeq ($(BLOWFISH_TARGET_SOC), $(filter mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += 00000000-0000-0000-0000-000000000046
endif

# Fingerprint Feature
ifeq ($(BLOWFISH_TARGET_SOC), $(filter mt6757,$(BLOWFISH_TARGET_SOC)))
ifneq ($(SEC_BUILD_CONF_USE_FINGERPRINT_TZ),false)
ifneq ($(findstring viper_samsung, $(SEC_BUILD_CONF_USE_FINGERPRINT_TZ)),)
FINGER1 := fingerprint/viper_samsung
else ifneq ($(findstring viper_vigis, $(SEC_BUILD_CONF_USE_FINGERPRINT_TZ)),)
FINGER1 := fingerprint/viper_vigis
else
FINGER1 := nothing
endif
ifneq ($(FINGER1),nothing)
LOCAL_REQUIRED_MODULES += \
        00000000-0000-0000-0000-46494e474502
endif

ifneq ($(findstring et3xx_samsung, $(SEC_BUILD_CONF_USE_FINGERPRINT_TZ)),)
FINGER2 := fingerprint/et3xx_samsung
else ifneq ($(findstring et5xx_egis, $(SEC_BUILD_CONF_USE_FINGERPRINT_TZ)),)
FINGER2 := fingerprint/et5xx_egis
else ifneq ($(findstring et5xx_suprema, $(SEC_BUILD_CONF_USE_FINGERPRINT_TZ)),)
FINGER2 := fingerprint/et5xx_suprema
else
FINGER2 := nothing
endif
ifneq ($(FINGER2),nothing)
LOCAL_REQUIRED_MODULES += \
        00000000-0000-0000-0000-46494e474552
endif
endif
endif # end of Fingerprint Feature

#Tiger Ta
$(info BlowFish TA makefile SOC : $(BLOWFISH_TARGET_SOC))

ifeq ($(BLOWFISH_TARGET_SOC), $(filter mt6757,$(BLOWFISH_TARGET_SOC)))
    ifeq ($(SEC_BUILD_CONF_USE_TIGER),true)
        $(info BlowFish makefile Tiger is enabled)
        LOCAL_REQUIRED_MODULES += 00000000-0000-0000-0000-544947455246
    endif
endif


#FaceRecognition TA
ifeq ($(SEC_BUILD_CONF_USE_FACE_TZ), bf_fr_tz) 
LOCAL_REQUIRED_MODULES += \
        00000000-0000-0000-0000-5345435f4652
endif #end of FaceRecognition feature

#bioSubModule TA
ifneq ($(SEC_BUILD_CONF_USE_IRIS_TZ),false)
BIO_SUBMODULE_ENABLE := true
else ifneq ($(findstring bf_fr_tz, $(SEC_BUILD_CONF_USE_FACE_TZ)),)
BIO_SUBMODULE_ENABLE := true
else
BIO_SUBMODULE_ENABLE := false
endif

ifeq ($(BIO_SUBMODULE_ENABLE),true)
LOCAL_REQUIRED_MODULES += \
        00000000-0000-0000-0000-42494f535542
endif

#DRK REQUIRED_MODULES
ifeq ($(BLOWFISH_TARGET_SOC), $(filter exynos7570 mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += \
	00000000-0000-0000-0000-000000534b4d \
	00000000-0000-0000-0000-505256544545 \
	00000000-0000-0000-0000-534543535452
endif

#SKMM_TA REQUIRED_MODULES
ifeq ($(BLOWFISH_TARGET_SOC), $(filter exynos7570 mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += \
    00000000-0000-0000-582f-586d3efb39b4
endif

#SVP/RPMB REQUIRED_MODULES
ifeq ($(BLOWFISH_TARGET_SOC), $(filter mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += \
	00000000-4d54-4b5f-4246-72706d626472 \
	00000000-4d54-4b5f-4246-72706d627461
endif

#CMDQ REQUIRED_MODULES
ifeq ($(BLOWFISH_TARGET_SOC), $(filter mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += \
	00000000-4d54-4b5f-4246-434d44515441 \
	00000000-4d54-4b5f-4246-434d44445256
endif

#M4U REQUIRED_MODULES
ifeq ($(BLOWFISH_TARGET_SOC), $(filter mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += \
	00000000-4d54-4b5f-4246-0000004d3455 \
	00000000-4d54-4b5f-4246-4d3455445441
endif

#DAPC REQUIRED_MODULES
ifeq ($(BLOWFISH_TARGET_SOC), $(filter mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += \
	00000000-4d54-4b5f-4246-444150437461 \
	00000000-4d54-4b5f-4246-444150436472
endif

#DRM HDCP REQUIRED_MODULES
ifeq ($(BLOWFISH_TARGET_SOC), $(filter mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += \
	00000000-4d54-4b5f-4246-445248444350
endif

#TUI Resource 1,2
ifeq ($(BLOWFISH_TARGET_SOC), $(filter mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += \
	ID00000100 \
	ID00000101
endif

#Touch/Display Driver TA
ifeq ($(BLOWFISH_TARGET_SOC), $(filter mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += \
    00000000-0000-0000-0000-000000010081 \
    00000000-0000-0000-0000-000000020081
endif

#Widevine key prov
ifneq ($(filter $(BLOWFISH_TARGET_SOC), mt6757),)
LOCAL_REQUIRED_MODULES += \
	00000000-4d54-4b5f-4246-57564e544100 \
	00000000-4d54-4b5f-4246-57564e647276
endif

#SecMem Module
ifeq ($(BLOWFISH_TARGET_SOC), $(filter mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += \
	00000000-4d54-4b5f-4246-534d454d5441 \
	00000000-4d54-4b5f-4246-534d45647276
endif

#Video Enc
ifneq ($(filter $(BLOWFISH_TARGET_SOC), mt6757),)
LOCAL_REQUIRED_MODULES += \
	00000000-4d54-4b5f-4246-566964456e63 \
	00000000-4d54-4b5f-4246-566964454452
endif

#Video Dec (H264)
ifneq ($(filter $(BLOWFISH_TARGET_SOC), mt6757),)
LOCAL_REQUIRED_MODULES += \
	00000000-4d54-4b5f-4246-564443323634 \
	00000000-4d54-4b5f-4246-564452323634
endif

#Video Dec (HEVC)
ifneq ($(filter $(BLOWFISH_TARGET_SOC), mt6757),)
LOCAL_REQUIRED_MODULES += \
	00000000-4d54-4b5f-4246-564448455643 \
	00000000-4d54-4b5f-4246-564452484556
endif

#SOFTSIM TA 
ifeq ($(BLOWFISH_TARGET_SOC), $(filter mt6757,$(BLOWFISH_TARGET_SOC)))
ifeq (true,$(call spf_check,SEC_PRODUCT_FEATURE_COMMON_SUPPORT_SOFTSIM,TRUE)) 
LOCAL_REQUIRED_MODULES += \
	00000000-0000-0000-0000-53465453494d \
	00000000-4d54-4b5f-4246-53465453494d
endif
endif

#FAST Attestation TA
ifeq ($(BLOWFISH_TARGET_SOC), $(filter mt6757,$(BLOWFISH_TARGET_SOC)))
LOCAL_REQUIRED_MODULES += \
    00000000-0000-0000-0000-534357494649
endif

LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := bin/$(BLOWFISH_TARGET_SOC)/tzdaemon
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/bin
include $(BUILD_PREBUILT)

ifneq ($(filter $(BLOWFISH_TARGET_SOC), exynos7570 mt6757),)
include $(CLEAR_VARS)
LOCAL_MODULE        := tzdaemon_recovery
LOCAL_MODULE_TAGS   := eng optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := bin/$(BLOWFISH_TARGET_SOC)/tzdaemon_recovery
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/bin
include $(BUILD_PREBUILT)
endif

include $(CLEAR_VARS)
LOCAL_MODULE        := taadaemon
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := bin/$(BLOWFISH_TARGET_SOC)/taadaemon
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/bin
include $(BUILD_PREBUILT)

include $(CLEAR_VARS)
LOCAL_MODULE        := proxy_daemon
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := bin/$(BLOWFISH_TARGET_SOC)/proxy_daemon
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/bin
include $(BUILD_PREBUILT)

include $(CLEAR_VARS)
LOCAL_MODULE        := startup.tzar
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/startup.tzar
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

include $(CLEAR_VARS)
LOCAL_MODULE                        := libteecl
ifeq ($(TARGET_2ND_ARCH),)
LOCAL_SRC_FILES_$(TARGET_ARCH)      := \
                                    lib/$(BLOWFISH_TARGET_SOC)/libteecl.so
else
LOCAL_SRC_FILES_$(TARGET_ARCH)      := \
                                    lib64/$(BLOWFISH_TARGET_SOC)/libteecl.so
LOCAL_SRC_FILES_$(TARGET_2ND_ARCH)  := \
                                    lib/$(BLOWFISH_TARGET_SOC)/libteecl.so
LOCAL_MULTILIB                      := both
endif
LOCAL_MODULE_TAGS                   := optional
LOCAL_PROPRIETARY_MODULE            := true
LOCAL_MODULE_CLASS                  := SHARED_LIBRARIES
LOCAL_MODULE_SUFFIX                 := .so
include $(BUILD_PREBUILT)

include $(CLEAR_VARS)
LOCAL_MODULE                        := libteecl_static
ifeq ($(TARGET_2ND_ARCH),)
LOCAL_SRC_FILES_$(TARGET_ARCH)      := \
                                    lib/$(BLOWFISH_TARGET_SOC)/libteecl.a
else
LOCAL_SRC_FILES_$(TARGET_ARCH)      := \
                                    lib64/$(BLOWFISH_TARGET_SOC)/libteecl.a
LOCAL_SRC_FILES_$(TARGET_2ND_ARCH)  := \
                                    lib/$(BLOWFISH_TARGET_SOC)/libteecl.a
LOCAL_MULTILIB                      := both
endif
LOCAL_MODULE_TAGS                   := optional
LOCAL_MODULE_CLASS                  := STATIC_LIBRARIES
LOCAL_MODULE_SUFFIX                 := .a
include $(BUILD_PREBUILT)

include $(CLEAR_VARS)
LOCAL_MODULE                        := libuuid
ifeq ($(TARGET_2ND_ARCH),)
LOCAL_SRC_FILES_$(TARGET_ARCH)      := \
                                    lib/$(BLOWFISH_TARGET_SOC)/libuuid.so
else
LOCAL_SRC_FILES_$(TARGET_ARCH)      := \
                                    lib64/$(BLOWFISH_TARGET_SOC)/libuuid.so
LOCAL_SRC_FILES_$(TARGET_2ND_ARCH)  := \
                                    lib/$(BLOWFISH_TARGET_SOC)/libuuid.so
LOCAL_MULTILIB                      := both
endif
LOCAL_MODULE_TAGS                   := optional
LOCAL_PROPRIETARY_MODULE            := true
LOCAL_MODULE_CLASS                  := SHARED_LIBRARIES
LOCAL_MODULE_SUFFIX                 := .so
include $(BUILD_PREBUILT)

include $(CLEAR_VARS)
LOCAL_MODULE                        := libuuid_static
ifeq ($(TARGET_2ND_ARCH),)
LOCAL_SRC_FILES_$(TARGET_ARCH)      := \
                                    lib/$(BLOWFISH_TARGET_SOC)/libuuid.a
else
LOCAL_SRC_FILES_$(TARGET_ARCH)      := \
                                    lib64/$(BLOWFISH_TARGET_SOC)/libuuid.a
LOCAL_SRC_FILES_$(TARGET_2ND_ARCH)  := \
                                    lib/$(BLOWFISH_TARGET_SOC)/libuuid.a
LOCAL_MULTILIB                      := both
endif
LOCAL_MODULE_TAGS                   := optional
LOCAL_MODULE_CLASS                  := STATIC_LIBRARIES
LOCAL_MODULE_SUFFIX                 := .a
include $(BUILD_PREBUILT)

#SKM_TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-000000534b4d
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-000000534b4d
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#TZ_DRIVE_TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-00535453540b
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-00535453540b
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#TIMA_TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-00535453540a
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-00535453540a
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-00535453540c
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-00535453540c
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-00535453540d
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-00535453540d
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-0053545354ab
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-0053545354ab
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-00000000dead
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-00000000dead
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#PROV_TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-505256544545
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-505256544545
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#SKMM_TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-582f-586d3efb39b4
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/00000000-0000-0000-582f-586d3efb39b4
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#dm-verity TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-00535453540f
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-00535453540f
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#SecureStorage TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-534543535452
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-534543535452
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#HDCP_TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-000048444350
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-000048444350
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#MirrorLink_TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-000000000046
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-000000000046
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

include $(CLEAR_VARS)
LOCAL_MODULE        := 18d9f073-18a5-4ade-9def-875e07f7f293_
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/18d9f073-18a5-4ade-9def-875e07f7f293_
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#Keymaster TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-4b45594d5354
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-4b45594d5354
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#Sem TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-53454d655345
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/sem/00000000-0000-0000-0000-53454d655345
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#SKPM TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-0000534b504d
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-0000534b504d
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#FINGERPRINT TA
ifneq ($(FINGER1),nothing)
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-46494e474502
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/$(FINGER1)/00000000-0000-0000-0000-46494e474502
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)
endif
ifneq ($(FINGER2),nothing)
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-46494e474552
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/$(FINGER2)/00000000-0000-0000-0000-46494e474552
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)
endif

#Tiger TA
ifeq ($(SEC_BUILD_CONF_USE_TIGER), true) 
include $(CLEAR_VARS)
$(info BlowFish makefile Tiger is TA build)

LOCAL_MODULE        := 00000000-0000-0000-0000-544947455246
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-544947455246
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)
endif #end of Tiger feature


#FaceRecognition TA
ifeq ($(SEC_BUILD_CONF_USE_FACE_TZ), bf_fr_tz) 
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-5345435f4652
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-5345435f4652
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)
endif #end of FaceRecognition feature

#bioSubModule TA
ifeq ($(BIO_SUBMODULE_ENABLE),true)
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-42494f535542
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-42494f535542
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)
endif

#Gatekeeper TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-474154454b45
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-474154454b45
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#Widevine Key install TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-57564e544100
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-57564e544100
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#Widevine Key install DRV
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-57564e647276
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-57564e647276
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#SecMem TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-534d454d5441
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-534d454d5441
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#SecMem Driver TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-534d45647276
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-534d45647276
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#Video Enc TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-566964456e63
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-566964456e63
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#Video Enc Driver TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-566964454452
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-566964454452
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#Video Dec(H264) TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-564443323634
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-564443323634
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#Video Dec(H264) Driver TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-564452323634
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-564452323634
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#Video Dec(HEVC) TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-564448455643
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-564448455643
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#Video Dec(HEVC) Driver TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-564452484556
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-564452484556
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#Vaultkeeper
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-564c544b5052
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-564c544b5052
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#WSM
ifeq (true,$(call spf_check,SEC_PRODUCT_FEATURE_SECURITY_SUPPORT_WSM,TRUE))
include $(CLEAR_VARS)
LOCAL_MODULE := ffffffff-0000-0000-0000-000000000030
LOCAL_SRC_FILES := tee/$(BLOWFISH_TARGET_SOC)/ffffffff-0000-0000-0000-000000000030
LOCAL_MODULE_CLASS := EXECUTABLES
LOCAL_MODULE_TAGS := optional
LOCAL_MODULE_PATH := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)
endif

#RPMB TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-72706d627461
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-72706d627461
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#RPMB DRV
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-72706d626472
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-72706d626472
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#CMDQ TA - intentionally put /system/tee/driver
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-434d44515441
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-434d44515441
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#CMDQ DRV
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-434d44445256
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-434d44445256
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#M4U TA - intentionally put /system/tee/driver
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-0000004d3455
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-0000004d3455
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#M4U DRV
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-4d3455445441
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-4d3455445441
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#DAPC TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-444150437461
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-444150437461
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#SOFTSIM TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-53465453494d
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-53465453494d
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#SOFTSIM driver TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-53465453494d
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-53465453494d
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#DAPC DRV
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-444150436472
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-444150436472
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#DRM HDCP DRV
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-4d54-4b5f-4246-445248444350
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-4d54-4b5f-4246-445248444350
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/driver
include $(BUILD_PREBUILT)

#TUI Resource 1
include $(CLEAR_VARS)
LOCAL_MODULE        := ID00000100
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/tui/ID00000100
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/tui
include $(BUILD_PREBUILT)

#TUI Resource 2 
include $(CLEAR_VARS)
LOCAL_MODULE        := ID00000101
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/tui/ID00000101
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee/tui
include $(BUILD_PREBUILT)

#Touch Driver TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-000000010081
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-000000010081
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#Display Driver TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-000000020081
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-000000020081
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

#FAST Attestation TA
include $(CLEAR_VARS)
LOCAL_MODULE        := 00000000-0000-0000-0000-534357494649
LOCAL_MODULE_TAGS   := optional
LOCAL_MODULE_CLASS  := EXECUTABLES
LOCAL_SRC_FILES     := tee/$(BLOWFISH_TARGET_SOC)/00000000-0000-0000-0000-534357494649
LOCAL_MODULE_PATH   := $(PRODUCT_OUT)/system/tee
include $(BUILD_PREBUILT)

ifeq ($(BLOWFISH_TARGET_SOC), $(filter exynos7570 mt6757,$(BLOWFISH_TARGET_SOC)))
MODULE_PATH := $(LOCAL_PATH)
include $(MODULE_PATH)/keymaster/Android.mk
include $(MODULE_PATH)/gatekeeper/Android.mk
endif
endif
